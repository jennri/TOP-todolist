(()=>{const e=document.querySelector("[data-list]"),t=document.querySelector("[data-new-list]"),n=document.querySelector("[data-new-input]"),a=document.querySelector("[delete-list-btn]"),l=document.querySelector("[data-list-display-container]"),i=document.querySelector("[data-list-title]"),o=document.querySelector("[data-list-count]"),c=document.querySelector("[data-tasks]"),d=document.querySelector("[task-template]"),r=document.querySelector("[data-new-task-form]"),s=document.querySelector("[data-new-task-input]"),u=document.querySelector("[data-clear-complete-tasks-btn]"),m=document.querySelector("[modal-input-container]"),p=document.querySelector("[modal-background]"),y="task.lists";let f=JSON.parse(localStorage.getItem(y))||[];const k="task.selectedListID";let S=localStorage.getItem(k);function g(){v(),q()}function v(){localStorage.setItem(y,JSON.stringify(f)),localStorage.setItem(k,S)}function q(){L(e),f.forEach((t=>{const n=document.createElement("li");n.dataset.listId=t.id,n.classList.add("listname"),n.innerText=t.name,t.id===S&&n.classList.add("active"),e.appendChild(n)}));const t=f.find((e=>e.id===S));null==S?l.style.display="none":(l.style.display="",i.innerText=t.name,h(t),L(c),function(e){e.task.forEach((e=>{const t=document.importNode(d.content,!0),n=t.querySelector("input");n.id=e.id,n.checked=e.complete;const a=t.querySelector("label");a.htmlFor=e.id,a.append(e.name),t.querySelector("button").addEventListener("click",(()=>{m.style.display="block",p.style.display="block"})),c.appendChild(t)}))}(t))}function h(e){const t=e.task.filter((e=>!e.complete)).length,n=1===t?"task":"tasks";o.innerText=`${t} ${n} remaining`}function L(e){for(;e.firstChild;)e.removeChild(e.firstChild)}q(),e.addEventListener("click",(e=>{"li"===e.target.tagName.toLowerCase()&&(S=e.target.dataset.listId,g())})),c.addEventListener("click",(e=>{if("input"===e.target.tagName.toLowerCase()){const t=f.find((e=>e.id===S));t.task.find((t=>t.id===e.target.id)).complete=e.target.checked,v(),h(t)}})),a.addEventListener("click",(()=>{f=f.filter((e=>e.id!==S)),S=null,g()})),u.addEventListener("click",(e=>{const t=f.find((e=>e.id===S));t.task=t.task.filter((e=>!e.complete)),g()})),p.addEventListener("click",(function(){m.style.display="none",p.style.display="none"})),t.addEventListener("submit",(e=>{e.preventDefault();const t=n.value;if(null==t||""===t)return;const a=(l=t,{id:Date.now().toString(),name:l,task:[]});var l;n.value=null,f.push(a),g()})),r.addEventListener("submit",(e=>{e.preventDefault();const t=s.value;if(null==t||""===t)return;const n=(a=t,{id:Date.now().toString(),name:a,details:"",priority:"",dateDue:"",complete:!1});var a;s.value=null,f.find((e=>e.id===S)).task.push(n),g()}))})();